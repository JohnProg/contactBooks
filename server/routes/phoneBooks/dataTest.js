/**
 * Created by Jerry on 16/6/22.
 */
var datas ={
    "datas": [
        {
            "id": 3,
            "username": "徐想",
            "password": "4b37d82745bc8c685a2848d88c43046bf7396ab5",
            "tel": "15950132561",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000001,
            "status": "上班",
            "addtime": "2016-04-16 18:15:01",
            "bz": "1111",
            "usertoken": "42008626c43b19445030a6b4c43f03e67be19d39",
            "depart_id": 2,
            "depart_cid": 1000001,
            "depart_name": "技术部",
            "depart_parentid": ""
        },
        {
            "id": 4,
            "username": "戴丽英",
            "password": "202a1a41b29ae1ac829bb8af81ece7f550ce5cb9",
            "tel": "13961876469",
            "position": "员工",
            "sex": "女",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000001,
            "status": "上班",
            "addtime": "2016-04-16 18:18:32",
            "bz": "111",
            "usertoken": null,
            "depart_id": 2,
            "depart_cid": 1000001,
            "depart_name": "技术部",
            "depart_parentid": ""
        },
        {
            "id": 6,
            "username": "孙鹏",
            "password": "747428da13d65840ef70bb18cd66cb1d302909c2",
            "tel": "18911805852",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000001,
            "status": "上班",
            "addtime": "2016-04-22 09:56:30",
            "bz": "",
            "usertoken": null,
            "depart_id": 2,
            "depart_cid": 1000001,
            "depart_name": "技术部",
            "depart_parentid": ""
        },
        {
            "id": 7,
            "username": "王强",
            "password": "26357dbdcfee1c2eb7460575741bb239da24b980",
            "tel": "13331134598",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000001,
            "status": "上班",
            "addtime": "2016-04-22 09:57:13",
            "bz": "",
            "usertoken": null,
            "depart_id": 2,
            "depart_cid": 1000001,
            "depart_name": "技术部",
            "depart_parentid": ""
        },
        {
            "id": 8,
            "username": "陈超",
            "password": "0e09f645e3dcecdfed24c6569b673c3c0f3a21c2",
            "tel": "18610280730",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000001,
            "status": "上班",
            "addtime": "2016-04-22 09:57:56",
            "bz": "",
            "usertoken": null,
            "depart_id": 2,
            "depart_cid": 1000001,
            "depart_name": "技术部",
            "depart_parentid": ""
        },
        {
            "id": 9,
            "username": "李承霖",
            "password": "0bcff9179046054e884012ac2cbdd0c3ff3624db",
            "tel": "18921130370",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000001,
            "status": "上班",
            "addtime": "2016-04-22 09:59:29",
            "bz": "",
            "usertoken": null,
            "depart_id": 2,
            "depart_cid": 1000001,
            "depart_name": "技术部",
            "depart_parentid": ""
        },
        {
            "id": 10,
            "username": "李海峰",
            "password": "826e6fb2c66eff6c615345f884540fe8f5dba626",
            "tel": "18018388360",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000001,
            "status": "上班",
            "addtime": "2016-04-22 10:00:21",
            "bz": "",
            "usertoken": null,
            "depart_id": 2,
            "depart_cid": 1000001,
            "depart_name": "技术部",
            "depart_parentid": ""
        },
        {
            "id": 13,
            "username": "融合",
            "password": "cd598b83c929cb565553398fef65293661c56352",
            "tel": "15950132562",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000001,
            "status": "上班",
            "addtime": "2016-04-22 16:34:24",
            "bz": "1111",
            "usertoken": null,
            "depart_id": 2,
            "depart_cid": 1000001,
            "depart_name": "技术部",
            "depart_parentid": ""
        },
        {
            "id": 14,
            "username": "大唐",
            "password": "9b93d5e6b6fb99b432ffffffa867be78da134655",
            "tel": "15950132541",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.8641906895209104.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000002,
            "status": "上班",
            "addtime": "2016-04-22 16:35:38",
            "bz": "111",
            "usertoken": null,
            "depart_id": 3,
            "depart_cid": 1000002,
            "depart_name": "销售部",
            "depart_parentid": ""
        },
        {
            "id": 15,
            "username": "大数据",
            "password": "efdb31f80e326c6ac7ea26b82979ec7047314e0a",
            "tel": "15950332561",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.45358054572716355.jpg",
            "email": "xuxiang32@163.com",
            "bmid": 1000002,
            "status": "上班",
            "addtime": "2016-04-22 16:37:04",
            "bz": "111",
            "usertoken": null,
            "depart_id": 3,
            "depart_cid": 1000002,
            "depart_name": "销售部",
            "depart_parentid": ""
        },
        {
            "id": 16,
            "username": "大唐电信",
            "password": "f4a7d5ba92bba6ba5febf62b9ac07dc9739d4b72",
            "tel": "15950152561",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/0.0598709371406585.jpg",
            "email": "xuxiang32@163.com",
            "bmid": 1000002,
            "status": "上班",
            "addtime": "2016-04-22 16:40:08",
            "bz": "111",
            "usertoken": null,
            "depart_id": 3,
            "depart_cid": 1000002,
            "depart_name": "销售部",
            "depart_parentid": ""
        },
        {
            "id": 17,
            "username": "大唐无锡",
            "password": "ee75d6f087ad7364401b2b100f5b995ef4ca0130",
            "tel": "15950532561",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/85883.38233530521.jpg",
            "email": "xuxiang32@163.com",
            "bmid": 1000003,
            "status": "上班",
            "addtime": "2016-04-22 16:41:45",
            "bz": "11",
            "usertoken": null,
            "depart_id": 4,
            "depart_cid": 1000003,
            "depart_name": "综合部",
            "depart_parentid": ""
        },
        {
            "id": 18,
            "username": "新员工",
            "password": "75819e26b44479c0d56814236e70b81e1ddbdd7e",
            "tel": "15957132561",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/71195.09314652532.jpg",
            "email": "xuxiang32@163.com",
            "bmid": 1000003,
            "status": "上班",
            "addtime": "2016-04-22 16:43:49",
            "bz": "11",
            "usertoken": null,
            "depart_id": 4,
            "depart_cid": 1000003,
            "depart_name": "综合部",
            "depart_parentid": ""
        },
        {
            "id": 19,
            "username": "临时工",
            "password": "b792a1f9251255969dcecbd202ef00b2288928d7",
            "tel": "15959132561",
            "position": "员工",
            "sex": "男",
            "avatar": "upload/dxliewmqbovkmsyi.jpg",
            "email": "xuxiang32@163.com",
            "bmid": 1000003,
            "status": "上班",
            "addtime": "2016-04-22 16:50:55",
            "bz": "11",
            "usertoken": null,
            "depart_id": 4,
            "depart_cid": 1000003,
            "depart_name": "综合部",
            "depart_parentid": ""
        },
        {
            "id": 20,
            "username": "融合",
            "password": "15ebcce13e5a83f1c23ed1e240478a8968d95487",
            "tel": "15958132561",
            "position": "员工",
            "sex": "男",
            "avatar": "/upload/xybhyzwklmsgjwtgldi.jpg",
            "email": "354971521@qq.com",
            "bmid": 1000003,
            "status": "上班",
            "addtime": "2016-04-22 17:02:37",
            "bz": "11",
            "usertoken": null,
            "depart_id": 4,
            "depart_cid": 1000003,
            "depart_name": "综合部",
            "depart_parentid": ""
        }
    ]
};


var datasWithDepart = {
    "id":'0',
    "name":'无锡融合',
    "series":[
        {
            "id":"1000001",
            "name":"技术部",
            "series":[
                {
                    "id": 3,
                    "username": "徐想",
                    "password": "4b37d82745bc8c685a2848d88c43046bf7396ab5",
                    "tel": "15950132561",
                    "position": "员工",
                    "sex": "男",
                    "avatar": "upload/0.8641906895209104.jpg",
                    "email": "354971521@qq.com",
                    "bmid": 1000001,
                    "status": "上班",
                    "addtime": "2016-04-16 18:15:01",
                    "bz": "1111",
                    "usertoken": "42008626c43b19445030a6b4c43f03e67be19d39",
                    "depart_id": 2,
                    "depart_cid": 1000001,
                    "depart_name": "技术部",
                    "depart_parentid": ""
                },
                {
                    "id": 3,
                    "username": "徐想",
                    "password": "4b37d82745bc8c685a2848d88c43046bf7396ab5",
                    "tel": "15950132561",
                    "position": "员工",
                    "sex": "男",
                    "avatar": "upload/0.8641906895209104.jpg",
                    "email": "354971521@qq.com",
                    "bmid": 1000001,
                    "status": "上班",
                    "addtime": "2016-04-16 18:15:01",
                    "bz": "1111",
                    "usertoken": "42008626c43b19445030a6b4c43f03e67be19d39",
                    "depart_id": 2,
                    "depart_cid": 1000001,
                    "depart_name": "技术部",
                    "depart_parentid": ""
                }
            ]
        },
        {
            "id":"1000001",
            "name":"技术部",
            "series":[
                {
                    "id": 3,
                    "username": "徐想",
                    "password": "4b37d82745bc8c685a2848d88c43046bf7396ab5",
                    "tel": "15950132561",
                    "position": "员工",
                    "sex": "男",
                    "avatar": "upload/0.8641906895209104.jpg",
                    "email": "354971521@qq.com",
                    "bmid": 1000001,
                    "status": "上班",
                    "addtime": "2016-04-16 18:15:01",
                    "bz": "1111",
                    "usertoken": "42008626c43b19445030a6b4c43f03e67be19d39",
                    "depart_id": 2,
                    "depart_cid": 1000001,
                    "depart_name": "技术部",
                    "depart_parentid": ""
                },
                {
                    "id": 3,
                    "username": "徐想",
                    "password": "4b37d82745bc8c685a2848d88c43046bf7396ab5",
                    "tel": "15950132561",
                    "position": "员工",
                    "sex": "男",
                    "avatar": "upload/0.8641906895209104.jpg",
                    "email": "354971521@qq.com",
                    "bmid": 1000001,
                    "status": "上班",
                    "addtime": "2016-04-16 18:15:01",
                    "bz": "1111",
                    "usertoken": "42008626c43b19445030a6b4c43f03e67be19d39",
                    "depart_id": 2,
                    "depart_cid": 1000001,
                    "depart_name": "技术部",
                    "depart_parentid": ""
                }
            ]
        }
    ]
};

//console.log(datasWithDepart.series[1].name);

var datasAll = datas.datas;

function datasWithDep(datas) {
    var newObj = {
        id:'0',
        name:'无锡融合',
        series:[]
    };
    var newArr=[];
    for(var i=0;i<datas.length;i++){
        //部门id
        var datasId = datas[i].bmid;
        //部门集合
        var faSeries = newObj.series;
        var bmOpt ={};
        if(faSeries.length<=0){
            //生成新部门
            bmOpt.id=datas[i].depart_cid;
            bmOpt.name=datas[i].depart_name;
            bmOpt.series = [];
            bmOpt.series.push(datas[i]);
            faSeries.push(bmOpt);
        }else{

            var count = 0;
            //遍历部门
            for(var j=0;j<faSeries.length;j++){
                var posId = faSeries[j].id;
                if(datasId == posId){
                    faSeries[j].series.push(datas[i]);
                }else{
                    //continue;
                   count++;
                }
            }
            if(count==faSeries.length){
                var newOpt={};
                newOpt.id=datas[i].depart_cid;
                newOpt.name=datas[i].depart_name;
                newOpt.series = [];
                newOpt.series.push(datas[i]);
                faSeries.push(newOpt);
            }
        }

    }
    return newObj;
}

var dataAll = datasWithDep(datasAll);

console.log(JSON.stringify(dataAll));


